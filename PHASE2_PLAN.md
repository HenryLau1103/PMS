# Phase 2: æŠ€è¡“åˆ†æåŠŸèƒ½ - å®Œæ•´å¯¦ä½œè¨ˆç•«

## ğŸ“Š æŠ€è¡“èª¿ç ”ç¸½çµ

### 1. TA-Lib æ•´åˆæ–¹æ¡ˆ
- **æ¨è–¦æ–¹æ¡ˆ**: `markcheno/go-talib` (ç´” Go å¯¦ä½œ)
- **å„ªå‹¢**: 
  - ç„¡éœ€ C/C++ ä¾è³´ï¼Œéƒ¨ç½²ç°¡å–®
  - æ”¯æ´ 200+ æŠ€è¡“æŒ‡æ¨™ (SMA, EMA, RSI, MACD, Bollinger Bands, KDJ ç­‰)
  - å¯ç”¨ `go-tart` å¯¦ç¾å¢é‡è¨ˆç®—å„ªåŒ–æ€§èƒ½
- **æ•ˆèƒ½å„ªåŒ–**: Go å”ç¨‹ä¸¦è¡Œè¨ˆç®—å¤šå€‹æŒ‡æ¨™

### 2. TradingView Lightweight Charts
- **æ¨è–¦æ–¹æ¡ˆ**: `lightweight-charts` + React wrapper
- **æ ¸å¿ƒåŠŸèƒ½**:
  - Kç·šåœ– (Candlestick) + æˆäº¤é‡æŸ±ç‹€åœ– (Histogram)
  - æŠ€è¡“æŒ‡æ¨™ç–ŠåŠ  (ç§»å‹•å¹³å‡ç·šã€å¸ƒæ—é€šé“ç­‰)
  - å¤šæ™‚é–“é€±æœŸåˆ‡æ› (1åˆ†/5åˆ†/æ—¥/é€±/æœˆ)
  - å³æ™‚æ•¸æ“šæ›´æ–° (WebSocket æ”¯æ´)
- **TypeScript åŸç”Ÿæ”¯æ´**

### 3. å°è‚¡æ­·å²æ•¸æ“šä¾†æº
- **å®˜æ–¹ä¾†æº**:
  - TWSE OpenAPI (æ—¥ç·šæ•¸æ“šï¼ŒJSON æ ¼å¼)
  - TPEx OpenAPI (æ«ƒè²·æ—¥ç·šæ•¸æ“š)
  - Data.gov.tw (CSV æ­·å²æ•¸æ“š)
- **ç¬¬ä¸‰æ–¹åº«**:
  - `twstock-go` (Go åº«ï¼Œç›´æ¥æŠ“å– TWSE/TPEx)
  - `FinMind` (å·²æ¸…ç†çš„æ­·å²æ•¸æ“šé›†)
- **å„²å­˜æ–¹æ¡ˆ**: TimescaleDB hypertable (OHLCV æ™‚åºæ•¸æ“š)

---

## ğŸ—ï¸ Phase 2 ç³»çµ±æ¶æ§‹è¨­è¨ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Frontend (Next.js)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“ˆ TradingView Chart Component                                â”‚
â”‚  â”œâ”€ Candlestick Series (Kç·š)                                   â”‚
â”‚  â”œâ”€ Volume Histogram (æˆäº¤é‡)                                   â”‚
â”‚  â”œâ”€ Indicator Overlays (æŠ€è¡“æŒ‡æ¨™ç·š)                            â”‚
â”‚  â””â”€ Timeframe Selector (æ™‚é–“é€±æœŸé¸æ“‡å™¨)                        â”‚
â”‚                                                                  â”‚
â”‚  ğŸ›ï¸ Indicator Control Panel                                    â”‚
â”‚  â”œâ”€ MA (ç§»å‹•å¹³å‡ç·š)                                             â”‚
â”‚  â”œâ”€ RSI (ç›¸å°å¼·å¼±æŒ‡æ¨™)                                          â”‚
â”‚  â”œâ”€ MACD (æŒ‡æ•¸å¹³æ»‘ç•°åŒç§»å‹•å¹³å‡ç·š)                               â”‚
â”‚  â””â”€ Bollinger Bands (å¸ƒæ—é€šé“)                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†• REST API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Backend API (Go/Fiber)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“Š Market Data Service                                         â”‚
â”‚  â”œâ”€ FetchHistoricalData() - å¾ TWSE/TPEx æŠ“å–æ­·å²æ•¸æ“š          â”‚
â”‚  â”œâ”€ GetOHLCV() - æŸ¥è©¢ K ç·šæ•¸æ“š (æ”¯æ´å¤šæ™‚é–“é€±æœŸ)                â”‚
â”‚  â””â”€ SyncDailyData() - æ¯æ—¥è‡ªå‹•åŒæ­¥æœ€æ–°æ•¸æ“š                      â”‚
â”‚                                                                  â”‚
â”‚  ğŸ”§ Technical Analysis Service (TA-Lib)                         â”‚
â”‚  â”œâ”€ CalculateMA(symbol, period, type) - ç§»å‹•å¹³å‡               â”‚
â”‚  â”œâ”€ CalculateRSI(symbol, period) - RSI æŒ‡æ¨™                    â”‚
â”‚  â”œâ”€ CalculateMACD(symbol) - MACD æŒ‡æ¨™                          â”‚
â”‚  â”œâ”€ CalculateBB(symbol, period) - å¸ƒæ—é€šé“                     â”‚
â”‚  â””â”€ CalculateKDJ(symbol) - KDJ æŒ‡æ¨™                            â”‚
â”‚                                                                  â”‚
â”‚  ğŸ”„ Indicator Cache Service (Redis)                            â”‚
â”‚  â””â”€ å¿«å–å·²è¨ˆç®—çš„æŒ‡æ¨™çµæœï¼Œé¿å…é‡è¤‡è¨ˆç®—                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†• SQL
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Database (TimescaleDB)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“¦ stock_ohlcv (Hypertable - æ™‚åºæ•¸æ“š)                        â”‚
â”‚  â”œâ”€ symbol, timestamp, open, high, low, close, volume          â”‚
â”‚  â”œâ”€ Continuous Aggregates (è‡ªå‹•èšåˆå¤šæ™‚é–“é€±æœŸ)                 â”‚
â”‚  â”‚  â”œâ”€ ohlcv_1min, ohlcv_5min, ohlcv_15min                     â”‚
â”‚  â”‚  â”œâ”€ ohlcv_1hour, ohlcv_daily, ohlcv_weekly                  â”‚
â”‚  â””â”€ Index: (symbol, timestamp DESC)                            â”‚
â”‚                                                                  â”‚
â”‚  ğŸ“¦ technical_indicators (å¿«å–è¡¨)                               â”‚
â”‚  â””â”€ symbol, indicator_type, params, calculated_at, data        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ Phase 2 å®Œæ•´å¯¦ä½œæ¸…å–®

### **éšæ®µ 2.1: æ­·å²æ•¸æ“šåŸºç¤å»ºè¨­** (é è¨ˆ 1 å¤©)

#### è³‡æ–™åº« Schema
- [ ] å»ºç«‹ `stock_ohlcv` hypertable (æ™‚åºæ•¸æ“šè¡¨)
  - æ¬„ä½: `symbol`, `timestamp`, `open`, `high`, `low`, `close`, `volume`, `turnover`
  - ç´¢å¼•: `(symbol, timestamp DESC)`
  - åˆ†å€ç­–ç•¥: æŒ‰æœˆè‡ªå‹•åˆ†å€
- [ ] å»ºç«‹ Continuous Aggregates (å¤šæ™‚é–“é€±æœŸè‡ªå‹•èšåˆ)
  - `ohlcv_1min`, `ohlcv_5min`, `ohlcv_15min`
  - `ohlcv_1hour`, `ohlcv_daily`, `ohlcv_weekly`, `ohlcv_monthly`
- [ ] å»ºç«‹ `technical_indicators` å¿«å–è¡¨
  - æ¬„ä½: `symbol`, `indicator_type`, `params`, `calculated_at`, `data` (JSONB)

#### å¾Œç«¯ - æ•¸æ“šåŒæ­¥æœå‹™
- [ ] å®‰è£ä¾è³´: `go get github.com/markcheno/go-talib`
- [ ] å»ºç«‹ `internal/services/market_data_service.go`
  - `FetchDailyData(symbol, startDate, endDate)` - å¾ TWSE API æŠ“å–æ—¥ç·š
  - `FetchIntradayData(symbol, date)` - æŠ“å–åˆ†é˜ç·š (å¦‚æœæœ‰ä¾†æº)
  - `SyncAllStocks()` - æ‰¹æ¬¡åŒæ­¥æ‰€æœ‰è‚¡ç¥¨æ­·å²æ•¸æ“š
  - `SyncLatestData()` - æ¯æ—¥è‡ªå‹•æ›´æ–°æœ€æ–°æ”¶ç›¤æ•¸æ“š
- [ ] å»ºç«‹ `internal/handlers/market_data_handler.go`
  - `GET /api/v1/stocks/:symbol/ohlcv` - æŸ¥è©¢ K ç·šæ•¸æ“š
    - Query params: `timeframe`, `from`, `to`, `limit`
  - `POST /api/v1/market/sync` - æ‰‹å‹•è§¸ç™¼æ•¸æ“šåŒæ­¥
- [ ] å»ºç«‹ CLI å·¥å…·: `cmd/sync-market/main.go`
  - æ”¯æ´æŒ‡å®šè‚¡ç¥¨ä»£è™Ÿæ‰¹æ¬¡åŒ¯å…¥æ­·å²æ•¸æ“š

#### æ¸¬è©¦é©—è­‰
- [ ] æ¸¬è©¦åŒæ­¥ 2330 (å°ç©é›») 2023-2024 å¹´å®Œæ•´æ—¥ç·šæ•¸æ“š
- [ ] é©—è­‰ TimescaleDB Continuous Aggregates è‡ªå‹•ç”Ÿæˆé€±ç·š/æœˆç·š
- [ ] æŸ¥è©¢æ•ˆèƒ½æ¸¬è©¦ (1è¬æ¢ K ç·šæ•¸æ“š < 100ms)

---

### **éšæ®µ 2.2: æŠ€è¡“åˆ†æå¼•æ“** (é è¨ˆ 1-2 å¤©)

#### å¾Œç«¯ - TA-Lib æ•´åˆ
- [ ] å»ºç«‹ `internal/services/technical_analysis_service.go`
  - `CalculateSMA(data []float64, period int)` - ç°¡å–®ç§»å‹•å¹³å‡
  - `CalculateEMA(data []float64, period int)` - æŒ‡æ•¸ç§»å‹•å¹³å‡
  - `CalculateRSI(data []float64, period int)` - RSI æŒ‡æ¨™
  - `CalculateMACD(data []float64)` - MACD æŒ‡æ¨™ (12, 26, 9)
  - `CalculateBollingerBands(data []float64, period int, stdDev float64)` - å¸ƒæ—é€šé“
  - `CalculateKDJ(high, low, close []float64, period int)` - KDJ æŒ‡æ¨™ (å°è‚¡å¸¸ç”¨)
- [ ] å»ºç«‹ `internal/handlers/indicator_handler.go`
  - `GET /api/v1/indicators/:symbol/ma` - ç§»å‹•å¹³å‡ç·š
    - Query: `period` (5, 10, 20, 60, 120, 240), `type` (SMA/EMA)
  - `GET /api/v1/indicators/:symbol/rsi` - RSI
    - Query: `period` (é»˜èª 14)
  - `GET /api/v1/indicators/:symbol/macd` - MACD
  - `GET /api/v1/indicators/:symbol/bb` - å¸ƒæ—é€šé“
  - `GET /api/v1/indicators/:symbol/kdj` - KDJ

#### Redis å¿«å–å±¤
- [ ] å¯¦ä½œæŒ‡æ¨™çµæœå¿«å–é‚è¼¯
  - Key æ ¼å¼: `indicator:{symbol}:{type}:{params}:{timeframe}`
  - TTL: æ—¥ç·šæŒ‡æ¨™ 24 å°æ™‚ï¼Œåˆ†é˜ç·š 5 åˆ†é˜
- [ ] å¿«å–å¤±æ•ˆç­–ç•¥ï¼šæ–°æ•¸æ“šåŒæ­¥å¾Œè‡ªå‹•æ¸…é™¤ç›¸é—œå¿«å–

#### æ•ˆèƒ½å„ªåŒ–
- [ ] Go å”ç¨‹ä¸¦è¡Œè¨ˆç®—å¤šå€‹æŒ‡æ¨™
- [ ] å¢é‡è¨ˆç®—ï¼šåªè¨ˆç®—æ–°å¢ K ç·šçš„æŒ‡æ¨™å€¼ (ä½¿ç”¨ `go-tart` æˆ–è‡ªè¡Œå¯¦ä½œ)

---

### **éšæ®µ 2.3: å‰ç«¯åœ–è¡¨ä»‹é¢** (é è¨ˆ 2-3 å¤©)

#### å®‰è£ä¾è³´
```bash
cd frontend
npm install lightweight-charts
npm install lightweight-charts-react-wrapper  # æˆ–æ‰‹å‹•å°è£
```

#### å»ºç«‹åœ–è¡¨çµ„ä»¶
- [ ] `frontend/src/components/Chart/StockChart.tsx`
  - ä¸»åœ–è¡¨çµ„ä»¶ (K ç·š + æˆäº¤é‡)
  - æ”¯æ´ç¸®æ”¾ã€æ‹–æ›³ã€åå­—ç·š
  - æ™‚é–“é€±æœŸåˆ‡æ›æŒ‰éˆ• (1åˆ†/5åˆ†/æ—¥/é€±/æœˆ)
- [ ] `frontend/src/components/Chart/ChartIndicators.tsx`
  - æŒ‡æ¨™æ§åˆ¶é¢æ¿ (é–‹é—œé¡¯ç¤º/éš±è—æŒ‡æ¨™)
  - åƒæ•¸èª¿æ•´ (ä¾‹å¦‚ MA é€±æœŸé¸æ“‡)
- [ ] `frontend/src/components/Chart/IndicatorOverlay.tsx`
  - åœ¨ä¸»åœ–ä¸Šç–ŠåŠ ç§»å‹•å¹³å‡ç·š
  - åœ¨ä¸»åœ–ä¸Šç–ŠåŠ å¸ƒæ—é€šé“
- [ ] `frontend/src/components/Chart/SubChart.tsx`
  - å­åœ–è¡¨çµ„ä»¶ (RSI, MACD, KDJ)
  - ç¨ç«‹çš„åƒ¹æ ¼åˆ»åº¦

#### æ•¸æ“šæ•´åˆ
- [ ] `frontend/src/lib/chartApi.ts`
  - `getOHLCV(symbol, timeframe, from, to)` - å–å¾— K ç·šæ•¸æ“š
  - `getIndicator(symbol, type, params)` - å–å¾—æŒ‡æ¨™æ•¸æ“š
- [ ] `frontend/src/types/chart.ts`
  - TradingView æ•¸æ“šæ ¼å¼ TypeScript ä»‹é¢

#### UI/UX è¨­è¨ˆ
- [ ] éŸ¿æ‡‰å¼ä½ˆå±€ (æ¡Œé¢å…¨è¢å¹•ï¼Œæ‰‹æ©Ÿå †ç–Š)
- [ ] æ·±è‰²ä¸»é¡Œé…è‰² (ç¬¦åˆé‡‘èè»Ÿé«”ç¿’æ…£)
- [ ] Loading ç‹€æ…‹ (éª¨æ¶å± Skeleton)
- [ ] éŒ¯èª¤è™•ç† (ç„¡æ•¸æ“šæç¤ºã€API éŒ¯èª¤)

---

### **éšæ®µ 2.4: åŠŸèƒ½æ•´åˆèˆ‡é é¢** (é è¨ˆ 1 å¤©)

#### å»ºç«‹æŠ€è¡“åˆ†æé é¢
- [ ] `frontend/src/app/analysis/page.tsx` - æŠ€è¡“åˆ†æå°ˆå±¬é é¢
  - ä¸Šæ–¹ï¼šè‚¡ç¥¨é¸æ“‡å™¨ (ä½¿ç”¨ç¾æœ‰çš„ StockAutocomplete)
  - ä¸­é–“ï¼šä¸»åœ–è¡¨å€åŸŸ (K ç·š + æŒ‡æ¨™)
  - ä¸‹æ–¹ï¼šæŒ‡æ¨™å­åœ– (RSI, MACD)
  - å³å´ï¼šæŒ‡æ¨™è¨­å®šé¢æ¿

#### èˆ‡ç¾æœ‰åŠŸèƒ½æ•´åˆ
- [ ] åœ¨ `PortfolioDashboard` æŒå€‰åˆ—è¡¨æ–°å¢ã€ŒæŸ¥çœ‹åœ–è¡¨ã€æŒ‰éˆ•
  - é»æ“Šè·³è½‰åˆ° `/analysis?symbol=2330`
- [ ] åœ¨ Header æ–°å¢ã€ŒæŠ€è¡“åˆ†æã€å°èˆªé€£çµ

#### API è·¯ç”±æ•´åˆ
- [ ] æ›´æ–° `backend/cmd/api/main.go`
  - è¨»å†Šå¸‚å ´æ•¸æ“šè·¯ç”±
  - è¨»å†ŠæŠ€è¡“æŒ‡æ¨™è·¯ç”±
  - æ–°å¢ CORS æ”¯æ´ (å…è¨±å‰ç«¯å­˜å–æ–°ç«¯é»)

---

### **éšæ®µ 2.5: æ¸¬è©¦èˆ‡å„ªåŒ–** (é è¨ˆ 1 å¤©)

#### åŠŸèƒ½æ¸¬è©¦
- [ ] E2E æ¸¬è©¦æµç¨‹ï¼š
  1. åŒæ­¥ 2330 æ­·å²æ•¸æ“š
  2. é–‹å•ŸæŠ€è¡“åˆ†æé é¢
  3. åˆ‡æ›æ™‚é–“é€±æœŸ (æ—¥ç·šã€é€±ç·šã€æœˆç·š)
  4. é–‹å•Ÿ MA5, MA10, MA20 é¡¯ç¤º
  5. é–‹å•Ÿ RSI å­åœ–
  6. é–‹å•Ÿ MACD å­åœ–
  7. é©—è­‰æ•¸æ“šæ­£ç¢ºæ€§ (å°ç…§ Yahoo Finance æˆ– Google Finance)

#### æ•ˆèƒ½å„ªåŒ–
- [ ] å‰ç«¯ï¼šè™›æ“¬æ»¾å‹• (å¤§é‡ K ç·šæ•¸æ“š)
- [ ] å¾Œç«¯ï¼šæŸ¥è©¢å„ªåŒ– (ç´¢å¼•é©—è­‰ã€EXPLAIN ANALYZE)
- [ ] å¿«å–å‘½ä¸­ç‡ç›£æ§ (Redis)
- [ ] å‰ç«¯ API è«‹æ±‚é˜²æŠ– (debounce)

#### æ–‡æª”æ›´æ–°
- [ ] æ›´æ–° `README.md` - Phase 2 å®Œæˆé …ç›®
- [ ] å»ºç«‹ `TECHNICAL_ANALYSIS.md` - æŠ€è¡“æŒ‡æ¨™ä½¿ç”¨æŒ‡å—
- [ ] æ›´æ–° API æ–‡æª” - æ–°å¢å¸‚å ´æ•¸æ“šèˆ‡æŒ‡æ¨™ç«¯é»

---

## ğŸ¯ Phase 2 å®Œæˆæ¨™æº–

### æ ¸å¿ƒåŠŸèƒ½æª¢æŸ¥æ¸…å–®
- [ ] âœ… å¯æŸ¥è©¢ä»»æ„å°è‚¡çš„æ­·å²æ—¥ç·š K ç·šæ•¸æ“š
- [ ] âœ… æ”¯æ´ 5 ç¨®å¸¸ç”¨æŠ€è¡“æŒ‡æ¨™ (MA, RSI, MACD, BB, KDJ)
- [ ] âœ… TradingView åœ–è¡¨æ­£ç¢ºé¡¯ç¤º K ç·šèˆ‡æˆäº¤é‡
- [ ] âœ… å¯åœ¨åœ–è¡¨ä¸Šç–ŠåŠ ç§»å‹•å¹³å‡ç·š
- [ ] âœ… å¯åˆ‡æ›æ™‚é–“é€±æœŸ (æ—¥/é€±/æœˆ)
- [ ] âœ… å­åœ–æ­£ç¢ºé¡¯ç¤º RSI èˆ‡ MACD
- [ ] âœ… æ•ˆèƒ½é”æ¨™ï¼šè¼‰å…¥åœ–è¡¨ < 2 ç§’ï¼Œåˆ‡æ›æŒ‡æ¨™ < 500ms

### æ•¸æ“šå“è³ªæª¢æŸ¥
- [ ] âœ… K ç·šæ•¸æ“šèˆ‡å®˜æ–¹ TWSE å°ç…§ç„¡èª¤å·®
- [ ] âœ… æŠ€è¡“æŒ‡æ¨™è¨ˆç®—æ­£ç¢º (èˆ‡ TradingView é©—è­‰)
- [ ] âœ… é™¤æ¬Šæ¯èª¿æ•´è™•ç†æ­£ç¢º (ä½¿ç”¨ corporate_actions è¡¨)

---

## ğŸ“¦ Phase 2 é æœŸäº¤ä»˜æˆæœ

### æ–°å¢æª”æ¡ˆ (ä¼°è¨ˆ 15-20 å€‹æª”æ¡ˆ)
```
backend/
â”œâ”€â”€ cmd/sync-market/main.go                    # NEW - å¸‚å ´æ•¸æ“šåŒæ­¥ CLI
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ market_data_service.go             # NEW - å¸‚å ´æ•¸æ“šæœå‹™
â”‚   â”‚   â””â”€â”€ technical_analysis_service.go      # NEW - æŠ€è¡“åˆ†ææœå‹™
â”‚   â””â”€â”€ handlers/
â”‚       â”œâ”€â”€ market_data_handler.go             # NEW - å¸‚å ´æ•¸æ“š API
â”‚       â””â”€â”€ indicator_handler.go               # NEW - æŠ€è¡“æŒ‡æ¨™ API

frontend/src/
â”œâ”€â”€ app/
â”‚   â””â”€â”€ analysis/
â”‚       â””â”€â”€ page.tsx                           # NEW - æŠ€è¡“åˆ†æé é¢
â”œâ”€â”€ components/
â”‚   â””â”€â”€ Chart/
â”‚       â”œâ”€â”€ StockChart.tsx                     # NEW - ä¸»åœ–è¡¨çµ„ä»¶
â”‚       â”œâ”€â”€ ChartIndicators.tsx                # NEW - æŒ‡æ¨™é¢æ¿
â”‚       â”œâ”€â”€ IndicatorOverlay.tsx               # NEW - æŒ‡æ¨™ç–ŠåŠ å±¤
â”‚       â””â”€â”€ SubChart.tsx                       # NEW - å­åœ–çµ„ä»¶
â”œâ”€â”€ lib/
â”‚   â””â”€â”€ chartApi.ts                            # NEW - åœ–è¡¨ API å®¢æˆ¶ç«¯
â””â”€â”€ types/
    â””â”€â”€ chart.ts                               # NEW - åœ–è¡¨é¡å‹å®šç¾©

database/migrations/
â””â”€â”€ 003_market_data.sql                        # NEW - å¸‚å ´æ•¸æ“š Schema
```

### æ–°å¢ API ç«¯é» (ä¼°è¨ˆ 8 å€‹)
```
# å¸‚å ´æ•¸æ“š
GET  /api/v1/stocks/:symbol/ohlcv              # æŸ¥è©¢ K ç·šæ•¸æ“š
POST /api/v1/market/sync                       # åŒæ­¥å¸‚å ´æ•¸æ“š

# æŠ€è¡“æŒ‡æ¨™
GET  /api/v1/indicators/:symbol/ma             # ç§»å‹•å¹³å‡ç·š
GET  /api/v1/indicators/:symbol/rsi            # RSI
GET  /api/v1/indicators/:symbol/macd           # MACD
GET  /api/v1/indicators/:symbol/bb             # å¸ƒæ—é€šé“
GET  /api/v1/indicators/:symbol/kdj            # KDJ
GET  /api/v1/indicators/:symbol/batch          # æ‰¹æ¬¡æŸ¥è©¢å¤šå€‹æŒ‡æ¨™
```

### è³‡æ–™åº«æ–°å¢
- 1 å€‹ Hypertable (`stock_ohlcv`)
- 7 å€‹ Continuous Aggregates (å¤šæ™‚é–“é€±æœŸ)
- 1 å€‹å¿«å–è¡¨ (`technical_indicators`)
- 5+ å€‹ç´¢å¼•

---

## â±ï¸ é ä¼°æ™‚ç¨‹

| éšæ®µ | å·¥ä½œå…§å®¹ | é ä¼°æ™‚é–“ |
|------|---------|---------|
| 2.1 | æ­·å²æ•¸æ“šåŸºç¤å»ºè¨­ | 1 å¤© |
| 2.2 | æŠ€è¡“åˆ†æå¼•æ“ | 1-2 å¤© |
| 2.3 | å‰ç«¯åœ–è¡¨ä»‹é¢ | 2-3 å¤© |
| 2.4 | åŠŸèƒ½æ•´åˆèˆ‡é é¢ | 1 å¤© |
| 2.5 | æ¸¬è©¦èˆ‡å„ªåŒ– | 1 å¤© |
| **ç¸½è¨ˆ** | | **6-8 å¤©** |

---

## ğŸš€ å»ºè­°åŸ·è¡Œé †åº

1. **å…ˆåšæ•¸æ“šåŸºç¤å»ºè¨­** (2.1) - æ²’æœ‰æ•¸æ“šä¸€åˆ‡éƒ½æ˜¯ç©ºè«‡
2. **å†åšå¾Œç«¯æŒ‡æ¨™è¨ˆç®—** (2.2) - ç¢ºä¿ API å¯ç”¨
3. **æœ€å¾Œåšå‰ç«¯åœ–è¡¨** (2.3, 2.4) - å‰ç«¯å¯ä»¥ç›´æ¥çœ‹åˆ°æˆæœ
4. **æŒçºŒæ¸¬è©¦å„ªåŒ–** (2.5) - ç©¿æ’åœ¨å„éšæ®µ

---

## ğŸ”§ æŠ€è¡“æ±ºç­–èˆ‡æœ€ä½³å¯¦è¸

### æ•¸æ“šä¾†æºç­–ç•¥
**æ±ºç­–**: å„ªå…ˆå¯¦ä½œæ—¥ç·šæ•¸æ“š (Daily OHLCV)
- **ç†ç”±**: 
  - å®˜æ–¹ TWSE/TPEx API æä¾›å…è²»å®Œæ•´æ—¥ç·šæ•¸æ“š
  - æ—¥ç·šæ•¸æ“šé‡é©ä¸­ï¼Œæ˜“æ–¼å­˜å„²èˆ‡æŸ¥è©¢
  - åˆ†é˜ç·šæ•¸æ“šéœ€è¦é¡å¤–çˆ¬èŸ²æˆ–ä»˜è²» APIï¼ŒPhase 2 å¯ä¸å¯¦ä½œ
- **æ•¸æ“šç¯„åœ**: å»ºè­°æŠ“å–æœ€è¿‘ 3-5 å¹´æ­·å²æ•¸æ“š
- **æ›´æ–°é »ç‡**: æ¯æ—¥æ”¶ç›¤å¾Œè‡ªå‹•åŒæ­¥ (å¯ç”¨ cron job æˆ–æ‰‹å‹•è§¸ç™¼)

### æŒ‡æ¨™å„ªå…ˆç´š
**æ±ºç­–**: å¯¦ä½œä»¥ä¸‹ 5 å€‹æ ¸å¿ƒæŒ‡æ¨™
1. **MA (ç§»å‹•å¹³å‡ç·š)**: SMA 5/10/20/60, EMA 12/26
2. **RSI (ç›¸å°å¼·å¼±æŒ‡æ¨™)**: 14 æ—¥ RSI
3. **MACD**: æ¨™æº–åƒæ•¸ (12, 26, 9)
4. **Bollinger Bands**: 20 æ—¥å‡ç·š Â± 2 æ¨™æº–å·®
5. **KDJ**: å°è‚¡æŠ•è³‡äººå¸¸ç”¨ï¼Œ9 æ—¥åƒæ•¸

**ç†ç”±**: é€™ 5 å€‹æŒ‡æ¨™æ¶µè“‹è¶¨å‹¢ã€å‹•é‡ã€è¶…è²·è¶…è³£ï¼Œè¶³ä»¥æ»¿è¶³ 80% æŠ•è³‡äººéœ€æ±‚

### UI/UX è¨­è¨ˆ
**æ±ºç­–**: ç¨ç«‹æŠ€è¡“åˆ†æé é¢ + æŒå€‰å¿«é€Ÿè·³è½‰
- **é é¢çµæ§‹**: `/analysis?symbol=2330`
- **æ•´åˆé»**: æŒå€‰åˆ—è¡¨æ¯è¡Œæ–°å¢ã€ŒğŸ“Š åœ–è¡¨ã€æŒ‰éˆ•
- **éŸ¿æ‡‰å¼**: æ¡Œé¢å„ªå…ˆï¼Œæ‰‹æ©Ÿæš«ä¸å„ªåŒ– (Phase 5 å†åš)

**ç†ç”±**: 
- åœ–è¡¨éœ€è¦å¤§è¢å¹•ç©ºé–“ï¼Œç¨ç«‹é é¢é«”é©—æ›´å¥½
- å¾æŒå€‰å¿«é€Ÿè·³è½‰ç¬¦åˆç”¨æˆ¶ç¿’æ…£ (çœ‹æŒå€‰ â†’ æŸ¥åœ–è¡¨ â†’ æ±ºç­–)

### å¿«å–ç­–ç•¥
**æ±ºç­–**: Redis å¿«å–å·²è¨ˆç®—çš„æŒ‡æ¨™çµæœ
- **å¿«å– Key**: `indicator:{symbol}:{type}:{params}:{timeframe}`
- **TTL**: æ—¥ç·š 24 å°æ™‚ï¼Œé€±ç·š 7 å¤©
- **å¤±æ•ˆç­–ç•¥**: æ–°æ•¸æ“šåŒæ­¥å¾Œæ¸…é™¤ç›¸é—œ symbol çš„å¿«å–

**ç†ç”±**: 
- æŠ€è¡“æŒ‡æ¨™è¨ˆç®—å¯†é›†ï¼Œå¿«å–å¯å¤§å¹…æå‡éŸ¿æ‡‰é€Ÿåº¦
- æ—¥ç·šæ•¸æ“šæ¯å¤©åªæ›´æ–°ä¸€æ¬¡ï¼Œ24 å°æ™‚ TTL åˆç†
- Redis è¼•é‡å¿«é€Ÿï¼Œé©åˆé€™ç¨®å ´æ™¯

### æ•ˆèƒ½ç›®æ¨™
- **K ç·šæŸ¥è©¢**: < 100ms (1000 æ¢è¨˜éŒ„)
- **æŒ‡æ¨™è¨ˆç®—**: < 200ms (å–®ä¸€æŒ‡æ¨™)
- **åœ–è¡¨è¼‰å…¥**: < 2 ç§’ (å®Œæ•´é é¢)
- **æŒ‡æ¨™åˆ‡æ›**: < 500ms (å‰ç«¯æ“ä½œ)

---

## ğŸ“š åƒè€ƒè³‡æº

### Go Libraries
- [markcheno/go-talib](https://github.com/markcheno/go-talib) - Pure Go TA-Lib
- [markcheno/go-quote](https://github.com/markcheno/go-quote) - è‚¡ç¥¨æ•¸æ“šæŠ“å–
- [iamjinlei/go-tart](https://github.com/iamjinlei/go-tart) - å¢é‡è¨ˆç®—å„ªåŒ–

### Frontend Libraries
- [TradingView Lightweight Charts](https://tradingview.github.io/lightweight-charts/)
- [lightweight-charts-react-wrapper](https://npmjs.com/package/lightweight-charts-react-wrapper)

### Taiwan Stock Data APIs
- [TWSE OpenAPI](https://openapi.twse.com.tw/)
- [TPEx OpenAPI](https://www.tpex.org.tw/openapi/v1/)
- [Data.gov.tw å°è‚¡æ•¸æ“š](https://data.gov.tw/en/datasets/11548)

### TimescaleDB Documentation
- [Continuous Aggregates Tutorial](https://docs.timescale.com/tutorials/latest/financial-ingest-real-time/)
- [OHLCV Aggregation Examples](https://docs.timescale.com/use-timescale/latest/continuous-aggregates/)

---

## âœ… Phase 2 Ready to Start

æ‰€æœ‰æŠ€è¡“èª¿ç ”å·²å®Œæˆï¼Œæ¶æ§‹è¨­è¨ˆå·²ç¢ºå®šï¼Œå¯¦ä½œè¨ˆç•«å·²åˆ¶å®šã€‚

**ä¸‹ä¸€æ­¥**: é–‹å§‹å¯¦ä½œ **éšæ®µ 2.1 - æ­·å²æ•¸æ“šåŸºç¤å»ºè¨­**

---

**æ–‡æª”ç‰ˆæœ¬**: 1.0  
**å»ºç«‹æ—¥æœŸ**: 2026-01-22  
**ç‹€æ…‹**: âœ… è¦åŠƒå®Œæˆï¼Œå¾…é–‹å§‹å¯¦ä½œ
